var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var RawData;
(function (RawData) {
    RawData.pieces = {
        "p": "\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<svg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   viewBox=\"0 0 2048 2048\"\n   id=\"svg3044\"\n   version=\"1.1\"\n   inkscape:version=\"0.48.4 r9939\"\n   width=\"100%\"\n   height=\"100%\"\n   sodipodi:docname=\"bP.svg\">\n  <metadata\n     id=\"metadata3054\">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about=\"\">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" />\n        <dc:title></dc:title>\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <defs\n     id=\"defs3052\" />\n  <sodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"2880\"\n     inkscape:window-height=\"1800\"\n     id=\"namedview3050\"\n     showgrid=\"false\"\n     inkscape:zoom=\"0.75195312\"\n     inkscape:cx=\"1024\"\n     inkscape:cy=\"1024\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg3044\" />\n  <g\n     transform=\"matrix(1 0 0 -1 0 2048)\"\n     id=\"g3046\">\n    <path\n       fill=\"#101010\"\n       d=\"M1024 205h-578v74q-4 80 41.5 137t125.5 108q117 91 171.5 217.5t78.5 267.5h-287l284 239q-86 74 -86 188q0 103 73 177t177 74q103 0 176.5 -74t73.5 -177q0 -114 -86 -188l284 -239h-287q23 -141 78 -267.5t172 -217.5q79 -51 124.5 -108t42.5 -137v-74h-578z\"\n       id=\"path3048\" />\n  </g>\n</svg>\n",
        "n": "\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<svg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   viewBox=\"0 0 2048 2048\"\n   id=\"svg2\"\n   version=\"1.1\"\n   inkscape:version=\"0.48.2 r9819\"\n   width=\"100%\"\n   height=\"100%\"\n   sodipodi:docname=\"bn.svg\">\n  <metadata\n     id=\"metadata12\">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about=\"\">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" />\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <defs\n     id=\"defs10\" />\n  <sodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"640\"\n     inkscape:window-height=\"678\"\n     id=\"namedview8\"\n     showgrid=\"false\"\n     inkscape:zoom=\"0.11523438\"\n     inkscape:cx=\"1024\"\n     inkscape:cy=\"1024\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg2\" />\n  <g\n     transform=\"matrix(1 0 0 -1 0 2048)\"\n     id=\"g4\">\n    <path\n       fill=\"#101010\"\n       d=\"M502 1180l-52 -1l-26 -64l69 -21l46 55zM1038 1367q34 -1 -16 68t-80 42l-116 -109zM700 1465q6 39 115.5 107.5t220.5 143.5l115 154l96 -217q342 -172 432.5 -417.5t47.5 -603.5q-18 -128 4.5 -236t57.5 -190l-1242 -1q-9 178 39 301.5t183 237.5q50 11 82.5 39.5 t53.5 58.5l62.5 1t138 29t139 97t66.5 207q0 17 -8.5 34t-11.5 37q-62 -228 -161 -288.5t-191 -58.5q-236 42 -292 -60l-56 -102l-217 121l115 82l-51 50l-122 -86l-12 297zM1681 273q-102 130 -85 308.5t27 362.5t-50 351.5t-316 275.5q220 -164 252.5 -342t16.5 -350.5 t-12 -329t167 -276.5z\"\n       id=\"path6\" />\n  </g>\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 1601.3052,1693.0403 c -81.081,-89.747 -91.5841,-156.5414 -74.2276,-472.0505 20.3789,-370.45059 -8.7512,-495.11834 -150.5575,-644.33895 -28.3483,-29.83051 -47.8136,-54.23729 -43.2562,-54.23729 17.0173,0 100.1093,58.43477 144.6504,101.72598 57.0521,55.45106 86.1396,107.89196 109.6386,197.66385 34.9938,133.6852 37.5437,201.94031 17.3275,463.81811 -19.9909,258.9589 -17.5419,312.6196 18.0578,395.6705 9.6985,22.6255 16.1305,42.6404 14.2935,44.4774 -1.8371,1.8371 -18.004,-12.891 -35.9265,-32.7291 l 0,0 z\"\n     id=\"path2989\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 896.70344,621.33017 c 55.68259,-53.26842 60.42184,-55.96132 78.1017,-44.37838 26.06806,17.07847 76.40326,84.06615 70.43026,93.73076 -2.6971,4.36392 -50.55804,7.80453 -106.35772,7.6458 l -101.45395,-0.2886 59.27971,-56.70958 z\"\n     id=\"path2991\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 464.27119,941.44594 c -27.44127,-6.6005 -31.26949,-14.68402 -20.9599,-44.25815 7.68249,-22.038 14.48333,-27.65559 33.48079,-27.65559 13.112,0 30.36269,7.20749 38.33486,16.01664 13.59229,15.01931 13.36664,17.45094 -3.62386,39.05085 -9.96529,12.66881 -20.76409,22.58121 -23.99733,22.02755 -3.23325,-0.55366 -13.6888,-2.88525 -23.23456,-5.1813 z\"\n     id=\"path2993\"\n     inkscape:connector-curvature=\"0\" />\n</svg>\n",
        "b": "\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<svg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   viewBox=\"0 0 2048 2048\"\n   id=\"svg2\"\n   version=\"1.1\"\n   inkscape:version=\"0.48.2 r9819\"\n   width=\"100%\"\n   height=\"100%\"\n   sodipodi:docname=\"bb.svg\">\n  <metadata\n     id=\"metadata12\">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about=\"\">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" />\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <defs\n     id=\"defs10\" />\n  <sodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"640\"\n     inkscape:window-height=\"700\"\n     id=\"namedview8\"\n     showgrid=\"false\"\n     inkscape:zoom=\"0.11523438\"\n     inkscape:cx=\"1024\"\n     inkscape:cy=\"1024\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg2\" />\n  <g\n     transform=\"matrix(1 0 0 -1 0 2048)\"\n     id=\"g4\">\n    <path\n       fill=\"#101010\"\n       d=\"M768 683q-5 -39 -26 -82h564q-18 36 -26 82h-512zM1263 756l46 73q-142 49 -285 47q-144 2 -285 -47l46 -73q118 40 239 38q120 2 239 -38zM831 529h-207q67 116 72 229q-114 119 -162 223.5t-6 223.5q33 96 118 189.5t312 246.5q-17 11 -46 36t-29 79q0 58 41 96t100 38 q58 0 99.5 -38t41.5 -96q0 -54 -29.5 -79t-45.5 -36q226 -153 311 -246.5t119 -189.5q42 -119 -6 -223.5t-162 -223.5q4 -113 72 -229h-207q-2 4 10 -16q33 -53 70 -60t89 -7h250q76 0 141.5 -62t65.5 -179h-495q-123 0 -223.5 84.5t-100.5 198.5q0 -114 -101 -198.5 t-223 -84.5h-495q0 117 65 179t142 62h250q51 0 88 7t71 60q12 20 10 16zM977 1230h-95v-89h95v-165h94v165h95v89h-95v104h-94v-104z\"\n       id=\"path6\" />\n  </g>\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 761.54028,1406.6983 12.85605,-39.0508 249.60367,0 249.6037,0 12.856,39.0508 12.8561,39.0509 -275.3158,0 -275.31577,0 12.85605,-39.0509 z\"\n     id=\"path2989\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 765.07813,1250.9479 -17.65316,-29.9199 44.99938,-13.0677 c 84.66507,-24.5867 172.41074,-33.5953 274.96545,-28.2302 54.8882,2.8715 113.4644,8.9793 130.1695,13.5729 16.7051,4.5936 46.7792,12.6064 66.8314,17.8062 l 36.4585,9.4541 -17.7902,30.1522 c -20.3271,34.4518 -23.3108,34.9921 -91.5848,16.5858 -68.72,-18.5267 -266.2284,-18.5267 -334.94845,0 -68.23049,18.3946 -71.26607,17.8518 -91.44762,-16.3534 z\"\n     id=\"path2991\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 980.61017,981.47797 0,-82.44068 -47.72881,0 -47.72882,0 0,-39.05085 0,-39.05085 47.72882,0 47.72881,0 0,-52.06779 0,-52.0678 43.38983,0 43.3898,0 0,52.0678 0,52.06779 47.7288,0 47.7289,0 0,39.05085 0,39.05085 -47.7289,0 -47.7288,0 0,82.44068 0,82.44063 -43.3898,0 -43.38983,0 0,-82.44063 z\"\n     id=\"path2993\"\n     inkscape:connector-curvature=\"0\" />\n</svg>\t\n",
        "r": "\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<svg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   viewBox=\"0 0 2048 2048\"\n   id=\"svg2\"\n   version=\"1.1\"\n   inkscape:version=\"0.48.2 r9819\"\n   width=\"100%\"\n   height=\"100%\"\n   sodipodi:docname=\"br.svg\">\n  <metadata\n     id=\"metadata12\">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about=\"\">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" />\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <defs\n     id=\"defs10\" />\n  <sodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"640\"\n     inkscape:window-height=\"709\"\n     id=\"namedview8\"\n     showgrid=\"false\"\n     inkscape:zoom=\"0.11523438\"\n     inkscape:cx=\"1024\"\n     inkscape:cy=\"1024\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg2\" />\n  <g\n     transform=\"matrix(1 0 0 -1 0 2048)\"\n     id=\"g4\">\n    <path\n       fill=\"#101010\"\n       d=\"M1024 205h-641l29 264l159 118l50 659l-149 107l-17 341h289v-147h137v147h143h143v-147h137v147h289l-17 -341l-149 -107l50 -659l159 -118l29 -264h-641zM1024 1194h333l-6 88h-327h-327l-6 -88h333zM1024 547h381l-6 87h-375h-375l-6 -87h381z\"\n       id=\"path6\" />\n  </g>\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 650.84746,1457.0305 0,-39.0508 373.15254,0 373.1525,0 0,39.0508 0,39.0509 -373.1525,0 -373.15254,0 0,-39.0509 z\"\n     id=\"path2989\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 694.23729,837.64068 c 0,-8.94915 2.44068,-28.47458 5.42373,-43.38983 l 5.42373,-27.11865 318.91525,0 318.9153,0 5.4237,27.11865 c 13.0658,65.32909 43.8795,59.66101 -324.339,59.66101 -316.64934,0 -329.76271,-0.64703 -329.76271,-16.27118 z\"\n     id=\"path2991\"\n     inkscape:connector-curvature=\"0\" />\n</svg>\n",
        "q": "\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<svg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   viewBox=\"0 0 2048 2048\"\n   id=\"svg2\"\n   version=\"1.1\"\n   inkscape:version=\"0.48.2 r9819\"\n   width=\"100%\"\n   height=\"100%\"\n   sodipodi:docname=\"bq.svg\">\n  <metadata\n     id=\"metadata12\">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about=\"\">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" />\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <defs\n     id=\"defs10\" />\n  <sodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"640\"\n     inkscape:window-height=\"667\"\n     id=\"namedview8\"\n     showgrid=\"false\"\n     inkscape:zoom=\"0.11523438\"\n     inkscape:cx=\"1024\"\n     inkscape:cy=\"1024\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg2\" />\n  <g\n     transform=\"matrix(1 0 0 -1 0 2048)\"\n     id=\"g4\">\n    <path\n       fill=\"#101010\"\n       d=\"M590 529q4 -72 -15 -158l134 86zM1024 205h-583q114 231 57.5 456.5t-202.5 449.5q-12 -2 -19 -2q-54 0 -92.5 38.5t-38.5 92.5t38.5 92.5t92.5 38.5t92.5 -38.5t38.5 -92.5q0 -20 -6 -38q-4 -14 -15 -33l196 -139l100 486q-64 31 -72 103q-5 44 29 91t88 53q54 5 96 -29 t48 -88q7 -68 -46 -114l198 -412l198 412q-54 46 -46 114q6 54 48 88t96 29q54 -6 87.5 -53t29.5 -91q-9 -72 -72 -103l100 -486l196 139q-12 19 -15 33q-6 18 -6 38q0 54 38.5 92.5t92.5 38.5t92.5 -38.5t38.5 -92.5t-38.5 -92.5t-92.5 -38.5q-7 0 -19 2 q-147 -224 -203 -449.5t58 -456.5h-583zM1024 655q109 0 222 -28.5t213 -67.5q2 41 11 89q-108 42 -221.5 68t-224.5 26t-225 -26t-221 -68q8 -48 11 -89q99 39 212 67.5t223 28.5zM1024 279h478q-15 34 -24 73h-454h-454q-10 -39 -24 -73h478zM1458 529l-119 -72l134 -86 q-20 86 -15 158zM885 482l139 -87l139 84l-139 86z\"\n       id=\"path6\" />\n  </g>\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 555.38983,1758.5831 c 0,-1.6742 4.2871,-15.342 9.52689,-30.3729 l 9.52689,-27.3288 449.55639,0 449.5564,0 9.5268,27.3288 c 5.2399,15.0309 9.527,28.6987 9.527,30.3729 0,1.6742 -210.8746,3.044 -468.6102,3.044 -257.73559,0 -468.61017,-1.3698 -468.61017,-3.044 z\"\n     id=\"path2989\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 952.36273,1602.4318 -58.62033,-37.2523 65.13723,-37.2686 65.13727,-37.2687 60.7373,36.0834 c 33.4055,19.8459 60.6625,38.8378 60.5711,42.2043 -0.2311,8.5096 -108.8863,71.2569 -122.911,70.98 -6.2872,-0.1242 -37.81039,-16.9893 -70.05157,-37.4781 l 0,0 z\"\n     id=\"path2991\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 1412.923,1632.6676 c -27.1228,-17.3706 -49.3851,-35.4879 -49.4716,-40.2608 -0.086,-4.7729 20.1524,-21.5067 44.9753,-37.1863 l 45.1326,-28.5082 5.2025,67.5591 c 2.8614,37.1575 4.8139,68.1036 4.339,68.7691 -0.475,0.6655 -23.0549,-13.0023 -50.1778,-30.3729 z\"\n     id=\"path2993\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 588.8,1452.531 c -0.71593,-16.1395 -1.6922,-33.6413 -2.16949,-38.8928 -2.09522,-23.0535 203.92127,-80.7864 343.77351,-96.3372 72.02368,-8.0087 114.68708,-8.0855 184.07668,-0.3314 140.5733,15.7087 348.9687,73.7829 346.8888,96.6686 -0.4773,5.2515 -1.4536,22.7533 -2.1695,38.8928 l -1.3017,29.3445 -101.9661,-32.592 c -133.917,-42.8047 -210.8059,-55.7092 -331.9322,-55.7092 -121.12634,0 -198.01519,12.9045 -331.9322,55.7092 L 590.10169,1481.8755 588.8,1452.531 z\"\n     id=\"path2995\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 587.65069,1602.7569 c 2.11115,-34.3298 4.52362,-65.41 5.36106,-69.0669 0.83744,-3.657 24.25108,7.5677 52.03032,24.9437 27.77924,17.3761 47.28358,34.5936 43.34299,38.2611 -3.9406,3.6676 -29.08154,20.531 -55.86876,37.4742 l -48.70404,30.8059 3.83843,-62.418 z\"\n     id=\"path2997\"\n     inkscape:connector-curvature=\"0\" />\n</svg>\n",
        "k": "\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<svg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   viewBox=\"0 0 2048 2048\"\n   id=\"svg2\"\n   version=\"1.1\"\n   inkscape:version=\"0.48.2 r9819\"\n   width=\"100%\"\n   height=\"100%\"\n   sodipodi:docname=\"bk.svg\">\n  <metadata\n     id=\"metadata12\">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about=\"\">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" />\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <defs\n     id=\"defs10\" />\n  <sodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"640\"\n     inkscape:window-height=\"673\"\n     id=\"namedview8\"\n     showgrid=\"false\"\n     inkscape:zoom=\"0.11523438\"\n     inkscape:cx=\"1024\"\n     inkscape:cy=\"1024\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg2\" />\n  <g\n     transform=\"matrix(1 0 0 -1 0 2048)\"\n     id=\"g4\">\n    <path\n       fill=\"#101010\"\n       d=\"M1024 279h489l-12 73h-477h-477l-12 -73h489zM1024 1200q-25 60 -62 111q31 48 62 65q30 -17 62 -65q-38 -51 -62 -111zM927 746q-154 -11 -303 -58q-123 108 -200 213.5t-77 201.5q0 89 73.5 159t148.5 70q67 0 134.5 -62.5t102.5 -130.5q30 -54 75 -175t46 -218z M577 529l-26 -156l145 84zM1024 1436q-47 0 -136 -121q-31 36 -50 55q93 140 186 140q92 0 186 -140q-20 -19 -50 -55q-90 121 -136 121zM1024 661q-1 126 -42 267.5t-84 226.5q-8 14 -14 27t-12 23q-28 43 -48 69q-51 63 -120 105t-134 42q-103 0 -208 -93t-105 -229 q0 -120 99 -254.5t249 -259.5q201 74 419 76zM1024 205h-576l61 365q-325 280 -326 535q-1 159 125 274.5t267 115.5q78 0 158.5 -47t142.5 -119q61 -74 98.5 -164.5t49.5 -150.5q12 60 49 150.5t99 164.5q61 72 142 119t159 47q140 0 266 -115.5t126 -274.5 q-2 -255 -326 -535l61 -365h-576zM1121 746q0 97 45 218t76 175q34 68 101.5 130.5t135.5 62.5q74 0 147.5 -70t74.5 -159q0 -96 -77 -201.5t-200 -213.5q-150 47 -303 58zM1471 529l-119 -72l145 -84zM1024 661q217 -2 419 -76q150 125 249 259.5t99 254.5 q0 136 -105.5 229t-207.5 93q-66 0 -135 -42t-119 -105q-21 -26 -48 -69q-6 -10 -12.5 -23l-13.5 -27q-44 -85 -85 -226.5t-41 -267.5zM885 502l139 -86l139 84l-139 86zM977 1750v95h94v-95h107v-95h-107v-153q-48 16 -94 0v153h-107v95h107z\"\n       id=\"path6\" />\n  </g>\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 1401.4915,1445.0218 c -78.8657,-27.9719 -280.8492,-63.4896 -361.055,-63.4896 -13.5729,0 -8.3701,-92.9378 9.9317,-177.4108 46.5412,-214.81404 134.473,-397.65875 231.4791,-481.3361 104.2876,-89.95837 202.4256,-110.29259 301.8815,-62.54996 101.7059,48.82269 168.8559,126.47534 192.6106,222.736 11.9521,48.43347 12.5067,65.83472 3.6329,113.99457 -20.0474,108.80099 -81.3793,205.35889 -221.2364,348.30369 -109.9971,112.4256 -114.1265,115.0451 -157.2444,99.7522 z m 122.8177,-179.6594 c 134.7609,-141.4644 175.4829,-214.4621 176.1913,-315.83774 0.4683,-67.03663 -13.4333,-101.83522 -61.5242,-154.00777 -143.4095,-155.58091 -315.1045,-83.45215 -434.3981,182.48989 -42.6209,95.01492 -76.4874,206.09722 -82.5156,270.65102 -5.7063,61.108 -10.2312,57.4923 84.8046,67.7654 26.5972,2.875 83.221,14.3756 125.8305,25.5568 42.6095,11.1812 81.9736,20.7494 87.4759,21.2628 5.5022,0.5134 52.3632,-43.5328 104.1356,-97.8804 l 0,0 z\"\n     id=\"path2989\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"M 522.69348,1378.7619 C 282.85431,1147.8294 214.58388,976.10591 297.00399,811.07562 307.70836,789.64221 338.00727,752.40497 364.33493,728.3262 467.72145,633.77083 573.50641,610.75174 673.3258,661.08895 778.26588,714.00843 850.6748,798.31641 911.25199,938.11388 969.78,1073.1823 1015.322,1248.2704 1015.322,1338.215 l 0,41.9358 -58.57624,5.339 c -104.0056,9.4797 -214.78092,29.5868 -283.86381,51.5246 l -67.44533,21.4179 -82.74314,-79.6704 z m 186.38255,-35.874 c 46.72683,-11.7086 106.43583,-23.6599 132.68668,-26.5583 95.0231,-10.4919 89.91439,-6.2064 83.92014,-70.3974 -6.61695,-70.8594 -56.45658,-218.8281 -106.45317,-316.0484 -88.352,-171.80383 -210.06736,-249.01461 -320.08376,-203.04682 -44.15978,18.45113 -116.43706,87.49453 -135.7522,129.67827 -19.05108,41.60706 -20.9871,132.18468 -3.85178,180.20755 22.6552,63.4927 71.07585,130.9368 164.1489,228.6396 51.77234,54.3476 95.54808,98.8139 97.27942,98.8139 1.73135,0 41.37895,-9.5798 88.10577,-21.2884 z\"\n     id=\"path2991\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"M 1003.3744,949.74058 C 986.85194,899.18356 931.32063,785.54395 906.05991,750.5957 c -13.35176,-18.4722 -11.90128,-21.12111 41.57869,-75.93221 38.00403,-38.94995 61.9944,-56.7923 76.3614,-56.7923 14.367,0 38.3574,17.84235 76.3614,56.7923 53.717,55.05403 54.9805,57.37814 41.2802,75.93221 -24.0218,32.53209 -99.7443,191.12876 -105.4708,220.90261 -2.9834,15.51186 -7.9186,28.17512 -10.9671,28.14057 -3.0485,-0.0347 -12.8717,-22.48878 -21.8293,-49.8983 l 0,0 z m 56.6668,-157.68022 31.7022,-59.81846 -28.5336,-31.15146 c -15.6935,-17.1333 -33.3379,-31.15146 -39.2098,-31.15146 -5.8719,0 -23.5163,14.01816 -39.20978,31.15146 l -28.53362,31.15146 31.70221,59.81846 c 17.43619,32.90016 33.65479,59.81847 36.04119,59.81847 2.3864,0 18.605,-26.91831 36.0412,-59.81847 z\"\n     id=\"path2993\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 961.08475,1587.5558 c -32.21695,-20.136 -58.54284,-38.6067 -58.50197,-41.046 0.0409,-2.4394 27.06664,-21.0865 60.05728,-41.4381 l 59.98294,-37.003 61.4343,36.958 c 33.7888,20.3268 61.4342,39.4619 61.4342,42.5224 0,4.9152 -115.8443,77.2345 -123.0087,76.7918 -1.552,-0.096 -29.18111,-16.6492 -61.39805,-36.7851 z\"\n     id=\"path2995\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 558.77664,1652.3188 c 2.3664,-8.1326 6.96336,-34.312 10.21546,-58.1764 8.99418,-66.0007 11.04011,-67.1917 62.32993,-36.2864 25.05763,15.0988 45.55933,29.9113 45.55933,32.9166 0,3.0053 -27.54164,21.4096 -61.20364,40.8985 -45.11665,26.1206 -60.07274,31.5477 -56.90108,20.6477 z\"\n     id=\"path2997\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 1431.8644,1631.7223 c -31.0237,-18.3043 -57.3928,-36.2297 -58.5979,-39.8342 -2.4479,-7.3215 86.9459,-63.409 92.3885,-57.9665 3.4172,3.4172 26.4635,128.9748 23.9283,130.3629 -0.7217,0.3952 -26.6952,-14.2578 -57.7189,-32.5622 z\"\n     id=\"path2999\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"fill:#ececec;fill-opacity:1;stroke:#101010;stroke-width:0;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:3.79999995;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0\"\n     d=\"m 545.06485,1732.9898 3.54586,-30.3729 475.38929,0 475.3893,0 3.5458,30.3729 3.5459,30.3729 -482.481,0 -482.48102,0 3.54587,-30.3729 z\"\n     id=\"path3001\"\n     inkscape:connector-curvature=\"0\" />\n</svg>\n"
    };
})(RawData || (RawData = {}));
var Piece = /** @class */ (function () {
    function Piece(_kind, _color) {
        if (_kind === void 0) { _kind = "-"; }
        if (_color === void 0) { _color = 0; }
        this.kind = _kind;
        this.color = _color;
    }
    Piece.prototype.algeb = function () {
        return this.kind + this.color;
    };
    Piece.prototype.empty = function () {
        return this.kind == "-";
    };
    Piece.prototype.equalto = function (p) {
        return ((this.kind == p.kind) && (this.color == p.color));
    };
    return Piece;
}());
var Square = /** @class */ (function () {
    function Square(_file, _rank) {
        this.file = _file;
        this.rank = _rank;
    }
    Square.prototype.Plus = function (sq) {
        return new Square(this.file + sq.file, this.rank + sq.rank);
    };
    Square.prototype.Minus = function (sq) {
        return new Square(this.file - sq.file, this.rank - sq.rank);
    };
    Square.prototype.isequalto = function (sq) {
        return ((this.file == sq.file) && (this.rank == sq.rank));
    };
    return Square;
}());
var GameNode = /** @class */ (function () {
    function GameNode() {
        this.childs = {};
        this.genalgeb = "";
        this.fen = "";
        this.parent = null;
    }
    GameNode.prototype.has = function (algeb) {
        var c = this.childs[algeb];
        return ((c != undefined) && (c != null));
    };
    GameNode.prototype.algebs = function () {
        return Object.keys(this.childs);
    };
    GameNode.prototype.haschild = function () {
        return (this.algebs().length > 0);
    };
    GameNode.prototype.mainchild = function () {
        var mainalgeb = this.algebs()[0];
        return this.childs[mainalgeb];
    };
    return GameNode;
}());
var Move = /** @class */ (function () {
    function Move(_fromsq, _tosq, _prom) {
        if (_prom === void 0) { _prom = new Piece(); }
        this.fromsq = _fromsq;
        this.tosq = _tosq;
        this.prom = _prom;
    }
    Move.prototype.roughlyequalto = function (m) {
        return ((this.fromsq.isequalto(m.fromsq)) && (this.tosq.isequalto(m.tosq)));
    };
    return Move;
}());
var Config;
(function (Config) {
    Config.scalefactor = 1.2;
    function Scaled(coord) { return coord * Config.scalefactor; }
    Config.Scaled = Scaled;
    function UnScaled(coord) { return coord / Config.scalefactor; }
    Config.UnScaled = UnScaled;
    var fpnext = {
        2: { 1: 0, 0: 1 },
        4: { 1: 2, 2: 0, 0: 3, 3: 1 }
    };
    function getvp(variant) {
        return VARIANT_PROPERTIES[variant];
    }
    Config.getvp = getvp;
    function getfpnext(variant) {
        return fpnext[getvp(variant).numplayers];
    }
    Config.getfpnext = getfpnext;
    var pawndirs = {
        2: [
            new Square(0, 1),
            new Square(0, -1)
        ],
        4: [
            new Square(0, 1),
            new Square(0, -1),
            new Square(-1, 0),
            new Square(1, 0)
        ]
    };
    function getpawndirs(variant) {
        return pawndirs[getvp(variant).numplayers];
    }
    Config.getpawndirs = getpawndirs;
    var movevectors = {
        "n": [
            new Square(1, 2),
            new Square(1, -2),
            new Square(-1, 2),
            new Square(-1, -2),
            new Square(2, 1),
            new Square(2, -1),
            new Square(-2, 1),
            new Square(-2, -1)
        ],
        "b": [
            new Square(1, 1),
            new Square(1, -1),
            new Square(-1, 1),
            new Square(-1, -1)
        ],
        "r": [
            new Square(1, 0),
            new Square(-1, 0),
            new Square(0, 1),
            new Square(0, -1)
        ],
        "q": [
            new Square(1, 0),
            new Square(-1, 0),
            new Square(0, 1),
            new Square(0, -1),
            new Square(1, 1),
            new Square(1, -1),
            new Square(-1, 1),
            new Square(-1, -1)
        ]
    };
    function getmovevectors(kind) {
        var k = (kind != "k" ? kind : "q");
        return movevectors[k];
    }
    Config.getmovevectors = getmovevectors;
    var VariantProperty = /** @class */ (function () {
        function VariantProperty(_id, _numplayers, _numfiles, _numranks, _startrawfen) {
            this.id = _id;
            this.numplayers = _numplayers;
            this.numfiles = _numfiles;
            this.numranks = _numranks;
            this.startrawfen = _startrawfen;
        }
        return VariantProperty;
    }());
    Config.SUPPORTED_VARIANTS = [
        "Standard",
        "Four Player"
    ];
    var VARIANT_BY_KEY = {
        "standard": "Standard",
        "fourplayer": "Four Player"
    };
    Config.PIECE_KINDS = ["p", "n", "b", "r", "q", "k"];
    function getvariantbykey(key) {
        return VARIANT_BY_KEY[key];
    }
    Config.getvariantbykey = getvariantbykey;
    var VARIANT_PROPERTIES = {
        "Standard": new VariantProperty("standard", 2, 8, 8, "r0n0b0q0k0b0n0r0" +
            "p0p0p0p0p0p0p0p0" +
            "-0-0-0-0-0-0-0-0" +
            "-0-0-0-0-0-0-0-0" +
            "-0-0-0-0-0-0-0-0" +
            "-0-0-0-0-0-0-0-0" +
            "p1p1p1p1p1p1p1p1" +
            "r1n1b1q1k1b1n1r1"),
        "Four Player": new VariantProperty("fourplayer", 4, 14, 14, "-0-0-0r0n0b0q0k0b0n0r0-0-0-0" +
            "-0-0-0p0p0p0p0p0p0p0p0-0-0-0" +
            "-0-0-0-0-0-0-0-0-0-0-0-0-0-0" +
            "r3p3-0-0-0-0-0-0-0-0-0-0p2r2" +
            "n3p3-0-0-0-0-0-0-0-0-0-0p2n2" +
            "b3p3-0-0-0-0-0-0-0-0-0-0p2b2" +
            "k3p3-0-0-0-0-0-0-0-0-0-0p2q2" +
            "q3p3-0-0-0-0-0-0-0-0-0-0p2k2" +
            "b3p3-0-0-0-0-0-0-0-0-0-0p2b2" +
            "n3p3-0-0-0-0-0-0-0-0-0-0p2n2" +
            "r3p3-0-0-0-0-0-0-0-0-0-0p2r2" +
            "-0-0-0-0-0-0-0-0-0-0-0-0-0-0" +
            "-0-0-0p1p1p1p1p1p1p1p1-0-0-0" +
            "-0-0-0r1n1b1k1q1b1n1r1-0-0-0")
    };
})(Config || (Config = {}));
var Utils;
(function (Utils) {
    var ScreenVector = /** @class */ (function () {
        function ScreenVector(_x, _y) {
            this.x = _x;
            this.y = _y;
        }
        ScreenVector.prototype.Scaled = function () {
            return new ScreenVector(Config.Scaled(this.x), Config.Scaled(this.y));
        };
        ScreenVector.prototype.UnScaled = function () {
            return new ScreenVector(Config.UnScaled(this.x), Config.UnScaled(this.y));
        };
        ScreenVector.prototype.Plus = function (sv) {
            return new ScreenVector(this.x + sv.x, this.y + sv.y);
        };
        ScreenVector.prototype.Minus = function (sv) {
            return new ScreenVector(this.x - sv.x, this.y - sv.y);
        };
        return ScreenVector;
    }());
    Utils.ScreenVector = ScreenVector;
    Utils.FILE_LETTER = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n"];
    Utils.RANK_LETTER = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "0"];
    Utils.FILE_LETTER_TO_FILE = { "a": 0, "b": 1, "c": 2, "d": 3, "e": 4, "f": 5, "g": 6, "h": 7, "i": 8, "j": 9, "k": 10, "l": 11, "m": 12, "n": 13 };
    Utils.FILE_TO_FILE_LETTER = { 0: "a", 1: "b", 2: "c", 3: "d", 4: "e", 5: "f", 6: "g", 7: "h", 8: "i", 9: "j", 10: "k", 11: "l", 12: "m", 13: "n" };
    function idpart(id, index) {
        var parts = id.split("_");
        return parts[index];
    }
    Utils.idpart = idpart;
    var Tokenizer = /** @class */ (function () {
        function Tokenizer(_content) {
            this.content = _content;
            this.tokens = _content.split("");
        }
        Tokenizer.prototype.pull = function (accept) {
            var buffer = "";
            while (this.tokens.length > 0) {
                var c = this.tokens[0];
                if (accept.indexOf(c) < 0)
                    return buffer;
                buffer += this.tokens.shift();
            }
            return buffer;
        };
        return Tokenizer;
    }());
    Utils.Tokenizer = Tokenizer;
})(Utils || (Utils = {}));
var Document_ = /** @class */ (function () {
    function Document_() {
    }
    Document_.prototype.appendChildToId = function (id, n_) {
        document.getElementById(id).appendChild(n_.n);
    };
    Document_.prototype.innerHTMLId = function (id, content) {
        document.getElementById(id).innerHTML = content;
    };
    Document_.prototype.getId = function (id) {
        return document.getElementById(id);
    };
    Document_.prototype.styleofId = function (id) {
        return this.getId(id).style.cssText;
    };
    Document_.prototype.setStyleofId = function (id, css) {
        this.getId(id).setAttribute("style", css);
    };
    return Document_;
}());
var Node_Globals;
(function (Node_Globals) {
    Node_Globals.doc = new Document_();
})(Node_Globals || (Node_Globals = {}));
//////////////////////////////////////////////////////////
var Node_ = /** @class */ (function () {
    function Node_(_id, _kind) {
        if (_id === void 0) { _id = ""; }
        // style
        this.properties = {};
        this.id = _id;
        this.kind = _kind;
        this.n = document.createElement(_kind);
        this.n.id = _id;
    }
    Node_.prototype.reportstyle = function () {
        var props = new Array();
        for (var key in this.properties) {
            props.push(key + ":" + this.properties[key]);
        }
        return props.join(";");
    };
    Node_.prototype.decomposestyle = function (css) {
        this.properties = {};
        var parts = css.split(";");
        for (var i in parts) {
            var partnospace = parts[i].replace(new RegExp(" ", "g"), "");
            var subparts = partnospace.split(":");
            if (subparts.length == 2) {
                var property = subparts[0];
                var value = subparts[1];
                this.properties[property] = value;
            }
        }
        return this;
    };
    Node_.prototype.getpx = function (property) {
        return parseFloat(this.properties[property].replace("px", ""));
    };
    Node_.prototype.s = function (property, value) { this.properties[property] = value; return this; };
    Node_.prototype.spx = function (property, value) { this.properties[property] = value + "px"; return this; };
    Node_.prototype.sspx = function (property, value) { this.properties[property] = Config.Scaled(value) + "px"; return this; };
    Node_.prototype.swpx = function (value) { this.properties["width"] = value + "px"; return this; };
    Node_.prototype.swspx = function (value) { this.properties["width"] = Config.Scaled(value) + "px"; return this; };
    Node_.prototype.shpx = function (value) { this.properties["height"] = value + "px"; return this; };
    Node_.prototype.shspx = function (value) { this.properties["height"] = Config.Scaled(value) + "px"; return this; };
    Node_.prototype.stpx = function (top) { this.properties["top"] = top + "px"; return this; };
    Node_.prototype.stspx = function (top) { this.properties["top"] = Config.Scaled(top) + "px"; return this; };
    Node_.prototype.slpx = function (left) { this.properties["left"] = left + "px"; return this; };
    Node_.prototype.slspx = function (left) { this.properties["left"] = Config.Scaled(left) + "px"; return this; };
    Node_.prototype.scol = function (col) { this.properties["color"] = col; return this; };
    Node_.prototype.sbcol = function (bcol) { this.properties["background-color"] = bcol; return this; };
    Node_.prototype.szi = function (z_index) { this.properties["z-index"] = "" + z_index; return this; };
    Node_.prototype.spos = function (position) { this.properties["position"] = position; return this; };
    Node_.prototype.spadpx = function (padding) { this.properties["padding"] = padding + "px"; return this; };
    Node_.prototype.spadspx = function (padding) { this.properties["padding"] = Config.Scaled(padding) + "px"; return this; };
    Node_.prototype.sop = function (opacity) { this.properties["opacity"] = "" + opacity; return this; };
    Node_.prototype.sburl = function (url) { this.properties["background"] = "url(" + url + ")"; return this; };
    Node_.prototype.finalize = function () {
        this.n.setAttribute("style", this.reportstyle());
        return this;
    };
    Node_.prototype.html = function (html) {
        this.n.innerHTML = html;
        this.finalize();
        return this;
    };
    Node_.prototype.attr = function (name, value) {
        this.n.setAttribute(name, value);
        return this;
    };
    Node_.prototype.appendChild = function (n_) {
        this.n.appendChild(n_.n);
    };
    Node_.prototype.a = function (n_) {
        this.n.appendChild(n_.n);
    };
    Node_.prototype.addel = function (kind, handler) {
        this.n.addEventListener(kind, handler);
        return this;
    };
    return Node_;
}());
var Div_ = /** @class */ (function (_super) {
    __extends(Div_, _super);
    function Div_(id) {
        if (id === void 0) { id = ""; }
        return _super.call(this, id, "div") || this;
    }
    return Div_;
}(Node_));
var Button_ = /** @class */ (function (_super) {
    __extends(Button_, _super);
    function Button_(caption, handler) {
        var _this = _super.call(this, "", "input") || this;
        _this.n.setAttribute("type", "button");
        _this.n.setAttribute("value", caption);
        _this.addel("mousedown", handler);
        return _this;
    }
    return Button_;
}(Node_));
var Option_ = /** @class */ (function (_super) {
    __extends(Option_, _super);
    function Option_(key, caption, selected) {
        if (selected === void 0) { selected = false; }
        var _this = _super.call(this, "", "option") || this;
        _this.n.setAttribute("id", key);
        _this.n.setAttribute("name", key);
        _this.n.setAttribute("value", key);
        _this.n.innerHTML = caption;
        if (selected) {
            _this.n.setAttribute("selected", "true");
        }
        return _this;
    }
    return Option_;
}(Node_));
var Select_ = /** @class */ (function (_super) {
    __extends(Select_, _super);
    function Select_(handler) {
        var _this = _super.call(this, "", "select") || this;
        _this.addel("change", handler);
        return _this;
    }
    return Select_;
}(Node_));
var ScreenVector = Utils.ScreenVector;
var doc = Node_Globals.doc;
var Board = /** @class */ (function () {
    function Board(_variant, _anchorid) {
        if (_variant === void 0) { _variant = Board.DEFAULT_VARIANT; }
        if (_anchorid === void 0) { _anchorid = ""; }
        this.constructor_func(_variant, _anchorid);
    }
    Board.prototype.setfromrawfen = function (fen) {
        for (var i = 0; i < this.area; i++) {
            var index = i * 2;
            var kind = fen[index];
            var color = +fen[index + 1];
            this.rep[i] = new Piece(kind, color);
        }
    };
    Board.prototype.whereisking = function (color) {
        if (color === void 0) { color = this.turn; }
        var testking = new Piece("k", color);
        for (var i = 0; i < this.area; i++) {
            if (this.rep[i].equalto(testking))
                return this.sqofi(i);
        }
        return null;
    };
    Board.prototype.getepd = function (pd, dc) {
        var epd = new Square(pd.file, pd.rank);
        if (pd.file == 0) {
            epd.file = dc;
        }
        else if (pd.rank == 0) {
            epd.rank = dc;
        }
        return epd;
    };
    Board.prototype.isattackedsqp = function (sq, p) {
        if (p.kind == "p") {
            for (var col = 0; col < this.numplayers; col++)
                if (col != p.color) {
                    var pd = this.pdirs[col];
                    for (var dc = -1; dc <= 1; dc += 2) {
                        var epd = this.getepd(pd, dc);
                        var tsq = sq.Minus(epd);
                        if (this.sqvalid(tsq)) {
                            var p_1 = this.getpieceatsq(tsq);
                            if ((p_1.kind == "p") && (p_1.color == col))
                                return true;
                        }
                    }
                }
        }
        else {
            var _a = this.psmovesforpieceat(p, sq, true, p.kind), moves = _a[0], capture = _a[1];
            if (capture)
                return true;
        }
        return false;
    };
    Board.prototype.isattackedsq = function (sq, color) {
        if (color === void 0) { color = this.turn; }
        var kinds = Config.PIECE_KINDS;
        for (var i in kinds) {
            var testpiece = new Piece(kinds[i], color);
            if (this.isattackedsqp(sq, testpiece))
                return true;
        }
        return false;
    };
    Board.prototype.isincheck = function (color) {
        if (color === void 0) { color = this.turn; }
        var wk = this.whereisking(color);
        if (wk == null)
            return true;
        return this.isattackedsq(wk, color);
    };
    Board.prototype.width = function () { return this.numfiles * this.SQUARE_SIZE; };
    Board.prototype.height = function () { return this.numranks * this.SQUARE_SIZE; };
    Board.prototype.indexof = function (f, r) { return f + this.numfiles * r; };
    Board.prototype.sqofi = function (i) {
        var f = (i % this.numfiles);
        var r = Math.floor(i / this.numfiles);
        return new Square(f, r);
    };
    Board.prototype.getpieceat = function (f, r) { return this.rep[this.indexof(f, r)]; };
    Board.prototype.getpieceatsq = function (sq) { return this.rep[this.indexof(sq.file, sq.rank)]; };
    Board.prototype.sqempty = function (sq) {
        return this.getpieceatsq(sq).empty();
    };
    Board.prototype.sqhaspiececolor = function (sq, color, exclude) {
        if (exclude === void 0) { exclude = false; }
        if (!this.sqvalid(sq))
            return false;
        var p = this.getpieceatsq(sq);
        if (p.empty())
            return false;
        if (exclude)
            return p.color != color;
        return p.color == color;
    };
    Board.prototype.setpieceat = function (f, r, p) { this.rep[this.indexof(f, r)] = p; };
    Board.prototype.setpieceatsq = function (sq, p) { this.rep[this.indexof(sq.file, sq.rank)] = p; };
    Board.prototype.rotsq = function (sq, rot) {
        if (rot == 0) {
            return sq;
        }
        if (rot < 0) {
            rot = 4 + rot;
        }
        if (rot == 1) {
            return new Square(this.lastrank - sq.rank, sq.file);
        }
        if (rot == 2) {
            return new Square(this.lastfile - sq.file, this.lastrank - sq.rank);
        }
        return new Square(sq.rank, this.lastfile - sq.file);
    };
    Board.prototype.sqalgeb = function (sq) {
        var fl = Utils.FILE_TO_FILE_LETTER[sq.file];
        var rl = "" + (this.numranks - sq.rank);
        return fl + rl;
    };
    Board.prototype.algebsq = function (algeb) {
        var t = new Utils.Tokenizer(algeb);
        var fl = t.pull(Utils.FILE_LETTER);
        var rl = t.pull(Utils.RANK_LETTER);
        var f = Utils.FILE_LETTER_TO_FILE[fl];
        var r = (this.numranks - parseInt(rl));
        return new Square(f, r);
    };
    Board.prototype.algebmove = function (algeb) {
        var t = new Utils.Tokenizer(algeb);
        var fromalgeb = t.pull(Utils.FILE_LETTER) + t.pull(Utils.RANK_LETTER);
        var toalgeb = t.pull(Utils.FILE_LETTER) + t.pull(Utils.RANK_LETTER);
        var fromsq = this.algebsq(fromalgeb);
        var tosq = this.algebsq(toalgeb);
        var m = new Move(fromsq, tosq);
        return m;
    };
    Board.prototype.movealgeb = function (m) {
        var algeb = this.sqalgeb(m.fromsq) + this.sqalgeb(m.tosq);
        if (m.prom.empty()) {
            algeb += m.prom.kind;
        }
        return algeb;
    };
    Board.prototype.makemove = function (m) {
        var frompiece = this.getpieceatsq(m.fromsq);
        var topiece = this.getpieceatsq(m.tosq);
        this.setpieceatsq(m.fromsq, new Piece());
        this.setpieceatsq(m.tosq, frompiece);
        this.advanceturn();
        var algeb = this.movealgeb(m);
        if (!this.current.has(algeb)) {
            var gn = new GameNode();
            gn.fen = this.reportfen();
            gn.genalgeb = algeb;
            gn.parent = this.current;
            this.current.childs[algeb] = gn;
        }
        this.current = this.current.childs[algeb];
    };
    Board.prototype.node_ = function () {
        this.pids = [];
        var boardcontainer = new Div_("boardcontainer").
            swspx(this.width() + 2.0 * this.BOARD_MARGIN).
            shspx(this.height() + 2.0 * this.BOARD_MARGIN).
            sburl("assets/images/backgrounds/wood.jpg").
            szi(Board.CONTAINER_Z_INDEX).
            spos("relative").
            finalize();
        var rootnode = new Div_("board").
            swspx(this.width()).
            shspx(this.height()).
            stspx(this.BOARD_MARGIN).
            slspx(this.BOARD_MARGIN).
            sburl("assets/images/backgrounds/wood.jpg").
            spos("absolute").
            szi(Board.BACKGROUND_Z_INDEX).
            finalize();
        for (var nf = 0; nf < this.numfiles; nf++) {
            for (var nr = 0; nr < this.numranks; nr++) {
                var sq = new Square(nf, nr);
                var algeb = this.sqalgeb(sq);
                var rsq = this.rotsq(sq, this.flip);
                var f = rsq.file;
                var r = rsq.rank;
                var sqdiv = new Div_().
                    stspx(r * this.SQUARE_SIZE).
                    slspx(f * this.SQUARE_SIZE).
                    swspx(this.SQUARE_SIZE).
                    shspx(this.SQUARE_SIZE).
                    sbcol((((nr + nf) % 2) == 0) ? Board.LIGHT_SQUARE_COLOR : Board.DARK_SQUARE_COLOR).
                    spos("absolute").
                    sop(Board.SQUARE_OPACITY).
                    szi(Board.SQUARE_Z_INDEX).
                    finalize();
                if (this.sqvalid(sq)) {
                    rootnode.appendChild(sqdiv);
                }
                var p = this.getpieceat(nf, nr);
                if (!p.empty()) {
                    var svg = RawData.pieces[p.kind];
                    var fillcol = Board.PIECE_FILL_COLORS[p.color];
                    var strokecol = Board.PIECE_STROKE_COLORS[p.color];
                    svg = svg.replace("fill=\"#101010\"", "fill=\"" + fillcol + "\"");
                    svg = svg.replace("fill:#ececec", "fill:" + strokecol);
                    svg = svg.replace("stroke:#101010", "stroke:" + fillcol);
                    var pid = "piece_" + algeb;
                    var pdiv = new Div_(pid).
                        stspx(r * this.SQUARE_SIZE + this.SQUARE_PADDING).
                        slspx(f * this.SQUARE_SIZE + this.SQUARE_PADDING).
                        swspx(this.PIECE_SIZE).
                        shspx(this.PIECE_SIZE).
                        spos("absolute").
                        sop(Board.PIECE_OPACITIES[p.color]).
                        attr("draggable", "true").
                        szi(Board.PIECE_Z_INDEX).
                        html(svg).
                        addel("dragstart", this.piecedragstart.bind(this));
                    rootnode.appendChild(pdiv);
                    this.pids.push(pid);
                }
            }
        }
        rootnode.addel("mousemove", this.boardmousemove.bind(this));
        rootnode.addel("mouseup", this.boardmouseup.bind(this));
        boardcontainer.a(rootnode);
        return boardcontainer;
    };
    Board.prototype.varianthandler = function (e) {
        var t = e.target;
        var key = t.selectedOptions[0].id;
        var selectedvariant = Config.getvariantbykey(key);
        this.constructor_func(selectedvariant, this.anchorid);
        this.draw();
    };
    Board.prototype.fliphandler = function (e) {
        this.flip += 1;
        if (this.flip > 3)
            this.flip = 0;
        this.draw();
    };
    Board.prototype.tonode = function (gn) {
        this.current = gn;
        this.setfromfen(gn.fen);
    };
    Board.prototype.tobegin = function () {
        this.tonode(this.root);
    };
    Board.prototype.tobeginhandler = function (e) {
        this.tobegin();
        this.draw();
    };
    Board.prototype.back = function () {
        if (this.current.parent != null) {
            this.tonode(this.current.parent);
        }
    };
    Board.prototype.backhandler = function (e) {
        this.back();
        this.draw();
    };
    Board.prototype.toend = function () {
        while (this.current.haschild()) {
            this.current = this.current.mainchild();
        }
        this.tonode(this.current);
    };
    Board.prototype.toendhandler = function (e) {
        this.toend();
        this.draw();
    };
    Board.prototype.forward = function () {
        if (this.current.haschild()) {
            this.tonode(this.current.mainchild());
        }
    };
    Board.prototype.forwardhandler = function (e) {
        this.forward();
        this.draw();
    };
    Board.prototype.setfromfen = function (fen) {
        var parts = fen.split(" ");
        var rawfen = parts[0];
        var turnfen = parts[1];
        var turn = parseInt(turnfen);
        this.setfromrawfen(rawfen);
        this.turn = turn;
    };
    Board.prototype.reportfen = function () {
        var buffer = "";
        for (var i = 0; i < this.area; i++) {
            buffer += this.rep[i].algeb();
        }
        return buffer + " " + this.turn;
    };
    Board.prototype.advanceturnonce = function () {
        this.turn = this.fpnext[this.turn];
    };
    Board.prototype.advanceturn = function () {
        this.advanceturnonce();
    };
    Board.prototype.reset = function () {
        this.setfromfen(this.startfen);
        this.root = new GameNode();
        this.root.fen = this.reportfen();
        this.current = this.root;
        this.randomon = false;
    };
    Board.prototype.resethandler = function (e) {
        this.reset();
        this.draw();
    };
    Board.prototype.makerandom = function () {
        if (!this.randomon)
            return;
        var lms = this.legalmoves();
        if (lms.length > 0) {
            var ri = Math.floor(Math.random() * lms.length);
            if (ri >= lms.length) {
                ri = 0;
            }
            this.makemove(lms[ri]);
            this.draw();
        }
        setTimeout(this.makerandom.bind(this), 1000);
    };
    Board.prototype.randomhandler = function (e) {
        if (this.randomon) {
            this.randomon = false;
            return;
        }
        this.randomon = true;
        this.makerandom();
    };
    Board.prototype.boardmousemove = function (e) {
        var me = e;
        if (this.dragunderway) {
            var client = new ScreenVector(me.clientX, me.clientY);
            this.dragd = client.Minus(this.dragstart);
            var nsv = this.dragstartst.Plus(this.dragd);
            var st = new Div_().decomposestyle(doc.styleofId(this.draggedid));
            st.slpx(nsv.x);
            st.stpx(nsv.y);
            st.szi(this.dragz);
            doc.setStyleofId(this.draggedid, st.reportstyle());
        }
    };
    Board.prototype.screenvectortosquare = function (sv) {
        var f = Math.floor(sv.x / this.SQUARE_SIZE);
        var r = Math.floor(sv.y / this.SQUARE_SIZE);
        return new Square(f, r);
    };
    Board.prototype.squaretoscreenvector = function (sq) {
        var x = sq.file * this.SQUARE_SIZE;
        var y = sq.rank * this.SQUARE_SIZE;
        return new ScreenVector(x, y);
    };
    Board.prototype.boardmouseup = function (e) {
        var me = e;
        if (this.dragunderway) {
            this.dragunderway = false;
            var dragdcorr = this.dragd.Plus(this.HALF_SQUARE_SIZE_SCREENVECTOR.Scaled());
            var dragdnom = dragdcorr.UnScaled();
            var dsq = this.screenvectortosquare(dragdnom);
            var dsv = this.squaretoscreenvector(dsq).Scaled();
            var nsv = this.dragstartst.Plus(dsv);
            var st = new Div_().decomposestyle(doc.styleofId(this.draggedid));
            st.slpx(nsv.x);
            st.stpx(nsv.y);
            doc.setStyleofId(this.draggedid, st.reportstyle());
            var draggedalgeb = Utils.idpart(this.draggedid, 1);
            var fromsqorig = this.rotsq(this.algebsq(draggedalgeb), this.flip);
            var tosq = this.rotsq(fromsqorig.Plus(dsq), -this.flip);
            var toalgeb = this.sqalgeb(tosq);
            var movealgeb = draggedalgeb + toalgeb;
            var m = this.algebmove(movealgeb);
            if (this.ismovelegal(m)) {
                this.makemove(m);
            }
            this.draw();
        }
    };
    Board.prototype.ismovelegal = function (m) {
        var lms = this.legalmoves();
        return lms.some(function (x) { return x.roughlyequalto(m); });
    };
    Board.prototype.legalmoves = function () {
        var psmoves = this.psmoves();
        var lmoves = [];
        for (var i in psmoves) {
            var testb = new Board(this.variant);
            testb.setfromfen(this.reportfen());
            var testm = psmoves[i];
            testb.makemove(testm);
            if (!testb.isincheck(this.turn))
                lmoves.push(testm);
        }
        return lmoves;
    };
    Board.prototype.piecedragstart = function (e) {
        var me = e;
        me.preventDefault();
        this.dragstart = new ScreenVector(me.clientX, me.clientY);
        this.draggedid = me.target["id"];
        this.dragz += 1;
        if (this.pids.indexOf(this.draggedid) >= 0) {
            var st = new Div_().decomposestyle(doc.styleofId(this.draggedid));
            this.dragstartst = new ScreenVector(st.getpx("left"), st.getpx("top"));
            this.dragunderway = true;
        }
        else {
            this.draw();
        }
    };
    Board.prototype.constructor_func = function (_variant, _anchorid) {
        if (_variant === void 0) { _variant = Board.DEFAULT_VARIANT; }
        if (_anchorid === void 0) { _anchorid = ""; }
        this.variant = _variant;
        this.anchorid = _anchorid;
        var vp = Config.getvp(_variant);
        this.numfiles = vp.numfiles;
        this.lastfile = vp.numfiles - 1;
        this.numranks = vp.numranks;
        this.lastrank = vp.numranks - 1;
        this.area = this.numfiles * this.numranks;
        this.rep = new Array(this.area);
        this.startrawfen = vp.startrawfen;
        this.startfen = vp.startrawfen + " 1";
        this.SQUARE_SIZE = (Board.DEFAULT_BOARD_SIZE / this.numranks);
        this.SQUARE_PADDING = (this.SQUARE_SIZE / 10.0);
        this.PIECE_SIZE = (this.SQUARE_SIZE - 2 * this.SQUARE_PADDING);
        this.HALF_SQUARE_SIZE = (this.SQUARE_SIZE / 2.0);
        this.HALF_SQUARE_SIZE_SCREENVECTOR = new ScreenVector(this.HALF_SQUARE_SIZE, this.HALF_SQUARE_SIZE);
        this.BOARD_MARGIN = (Board.DEFAULT_BOARD_SIZE / 50.0);
        if (this.flip == undefined) {
            this.flip = 0;
        }
        this.numplayers = vp.numplayers;
        this.lastplayer = this.numplayers - 1;
        this.fpnext = Config.getfpnext(this.variant);
        this.pdirs = Config.getpawndirs(this.variant);
        this.reset();
    };
    Board.prototype.IS_FOUR_PLAYER = function () { return this.variant == "Four Player"; };
    Board.prototype.sqvalid = function (sq) {
        if (this.IS_FOUR_PLAYER()) {
            if ((sq.file < 3) && (sq.rank < 3))
                return false;
            if ((sq.file < 3) && (sq.rank > 10))
                return false;
            if ((sq.file > 10) && (sq.rank > 10))
                return false;
            if ((sq.file > 10) && (sq.rank < 3))
                return false;
        }
        if ((sq.file < 0) || (sq.file > this.lastfile))
            return false;
        if ((sq.rank < 0) || (sq.rank > this.lastrank))
            return false;
        return true;
    };
    Board.prototype.nonsliding = function (p) {
        return ((p.kind == "k") || (p.kind == "n") || (p.kind == "p"));
    };
    Board.prototype.psmoves = function () {
        var moves = [];
        for (var f = 0; f < this.numfiles; f++) {
            for (var r = 0; r < this.numranks; r++) {
                var sq = new Square(f, r);
                var p = this.getpieceatsq(sq);
                if (p.color == this.turn) {
                    var _a = this.psmovesforpieceat(p, sq), ms = _a[0], capture = _a[1];
                    moves = moves.concat(ms);
                }
            }
        }
        return moves;
    };
    Board.prototype.psmovesforpieceat = function (p, sq, stopatfirstcapture, capturekind // has to be set if stopatfirstcapture is true
    ) {
        if (stopatfirstcapture === void 0) { stopatfirstcapture = false; }
        if (capturekind === void 0) { capturekind = null; } // has to be set if stopatfirstcapture is true
        var moves = [];
        if (p.kind == "p") {
            var pdir = this.pdirs[p.color];
            var basepawn = (!(this.sqvalid(sq.Minus(pdir).Minus(pdir))));
            var aheadsq = sq.Plus(pdir);
            if (this.sqvalid(aheadsq)) {
                if (this.sqempty(aheadsq)) {
                    moves.push(new Move(sq, aheadsq));
                    if (basepawn) {
                        var pushbytwosq = aheadsq.Plus(pdir);
                        if (this.sqvalid(pushbytwosq)) {
                            if (this.sqempty(pushbytwosq)) {
                                moves.push(new Move(sq, pushbytwosq));
                            }
                        }
                    }
                }
            }
            for (var dc = -1; dc <= 1; dc += 2) {
                var epd = this.getepd(pdir, dc);
                var capsq = sq.Plus(epd);
                if (this.sqvalid(capsq)) {
                    if (this.sqhaspiececolor(capsq, p.color, true)) {
                        moves.push(new Move(sq, capsq));
                        if (stopatfirstcapture) {
                            if (this.getpieceatsq(capsq).kind == capturekind) {
                                return [moves, true];
                            }
                        }
                    }
                }
            }
        }
        else {
            var mvs = Config.getmovevectors(p.kind);
            for (var i in mvs) {
                var mv = mvs[i];
                var csq = sq;
                while (this.sqvalid(csq.Plus(mv))) {
                    csq = csq.Plus(mv);
                    if (this.sqhaspiececolor(csq, p.color))
                        break;
                    if (this.sqempty(csq)) {
                        moves.push(new Move(sq, csq));
                    }
                    else if (this.sqhaspiececolor(csq, p.color, true)) {
                        moves.push(new Move(sq, csq));
                        if (stopatfirstcapture) {
                            if (this.getpieceatsq(csq).kind == capturekind) {
                                return [moves, true];
                            }
                        }
                        break;
                    }
                    if (this.nonsliding(p))
                        break;
                }
            }
        }
        return [moves, false];
    };
    Board.prototype.movesalgeb = function (moves) {
        var _this = this;
        return moves.map(function (m) { return _this.movealgeb(m); });
    };
    Board.prototype.draw = function () {
        if (this.anchorid != "") {
            doc.innerHTMLId(this.anchorid, "");
            doc.appendChildToId(this.anchorid, this.node_());
            var controlsdiv = new Div_();
            var variantcombo = new Select_(this.varianthandler.bind(this));
            for (var i in Config.SUPPORTED_VARIANTS) {
                var v = Config.SUPPORTED_VARIANTS[i];
                var k = Config.getvp(v).id;
                var s = (v == this.variant);
                variantcombo.a(new Option_(k, v, s));
            }
            controlsdiv.a(variantcombo);
            controlsdiv.a(new Button_("Flip", this.fliphandler.bind(this)));
            controlsdiv.a(new Button_("<<", this.tobeginhandler.bind(this)));
            controlsdiv.a(new Button_("<", this.backhandler.bind(this)));
            controlsdiv.a(new Button_(">", this.forwardhandler.bind(this)));
            controlsdiv.a(new Button_(">>", this.toendhandler.bind(this)));
            controlsdiv.a(new Button_("Reset", this.resethandler.bind(this)));
            controlsdiv.a(new Button_("Random", this.randomhandler.bind(this)));
            doc.appendChildToId(this.anchorid, controlsdiv);
            this.dragz = Board.DRAGGED_PIECE_Z_INDEX;
        }
    };
    Board.DEFAULT_VARIANT = "Standard";
    Board.DEFAULT_BOARD_SIZE = 400.0;
    Board.PIECE_OPACITIES = [1.0, 1.0, 1.0, 1.0];
    Board.PIECE_FILL_COLORS = ["#000000", "#ffffff", "#ffff00", "#ff0000"];
    Board.PIECE_STROKE_COLORS = ["#ffffff", "#dfdfdf", "#afafaf", "#afafaf"];
    Board.SQUARE_OPACITY = 0.2;
    Board.DARK_SQUARE_COLOR = "#8f8f8f";
    Board.LIGHT_SQUARE_COLOR = "#dfdfdf";
    Board.CONTAINER_Z_INDEX = 10;
    Board.BACKGROUND_Z_INDEX = 50;
    Board.SQUARE_Z_INDEX = 100;
    Board.PIECE_Z_INDEX = 200;
    Board.DRAGGED_PIECE_Z_INDEX = 500;
    return Board;
}());
var b = new Board("Four Player", "root");
b.draw();
b.randomhandler(null);
